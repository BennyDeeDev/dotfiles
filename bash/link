link() {
	local source="$1"
	local target="$2"

	mkdir -p "$(dirname "$target")"

	# If a real directory/file already exists, move it aside so target becomes a direct symlink.
	if [[ -e "$target" && ! -L "$target" ]]; then
		local backup="$target.bak.$(date +%Y%m%d-%H%M%S)"
		echo "Backing up existing $target -> $backup"
		mv "$target" "$backup"
	fi

	ln -sfn "$source" "$target"
	echo "Linked $target -> $source"
}

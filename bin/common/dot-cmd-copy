#!/bin/bash

# Copy from source to target, backing up any existing files

source="$1"
target="$2"

if [[ -z "$source" || -z "$target" ]]; then
  echo "Usage: dot-cmd-copy <source> <target>"
  exit 1
fi

mkdir -p "$(dirname "$target")"

if [[ -e "$target" || -L "$target" ]]; then
  backup="$target.bak.$(date +%Y%m%d-%H%M%S)"
  echo "Backing up existing $target -> $backup"
  mv "$target" "$backup"
fi

cp -rf "$source" "$target"
echo "Copied $source -> $target"

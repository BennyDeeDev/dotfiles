#!/bin/bash

# Clone or update docs repos from Docsfile

set -euo pipefail

DOCS_DIR="$HOME/Docs"
DOCSFILE="$HOME/Repos/dotfiles/Docsfile"

if [[ ! -f "$DOCSFILE" ]]; then
  echo "Docsfile not found at $DOCSFILE"
  exit 1
fi

mkdir -p "$DOCS_DIR"

while IFS= read -r line || [[ -n "$line" ]]; do
  [[ "$line" =~ ^#.*$ ]] && continue
  [[ -z "$line" ]] && continue

  repo="$line"
  reponame="${repo##*/}"
  target_dir="$DOCS_DIR/$reponame"

  if [[ -d "$target_dir" ]]; then
    echo "Updating $reponame..."
    git -C "$target_dir" pull --ff || true
  else
    echo "Cloning $repo..."
    git clone --depth 1 "https://github.com/$repo.git" "$target_dir"
  fi
done < "$DOCSFILE"

echo "Done! Docs available in $DOCS_DIR"
